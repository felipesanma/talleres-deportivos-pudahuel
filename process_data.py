import pandas as pd
import streamlit as st

ubicaciones_coords = {
    "PAPA SAN PEDRO #9431. SEDE ALTO JAHUEL": (-33.4502668,-70.7684665),
    "ESPAÑA #305": (-33.4597131,-70.7596445),
    "CORONA SUECA #8325. ESTADIO MUNICIPAL": (-33.4487486, -70.7421604),
    "CORONA SUECA #8325. GIMNASIO MUNICIPAL": (-33.4487486, -70.7421604),
    "CORONA SUECA #8325. CANCHAS DE TENIS": (-33.4487486, -70.7421604),
    "ALFA DE LA CRUZ #8564. CIGNUS CON ARA": (-33.4610778,-70.755232),
    "CIGNUS CON ARA": (-33.4610778,-70.755232),
    "VICTOR JARA CON TIERRA DEL FUEGO UV28": (-33.4571912,-70.7614732),
    "VICTOR JARA CON TIERRA DEL FUEGO": (-33.4571912,-70.7614732),
    "TIERRA DEL FUEGO CON AUSTRAL": (-33.4599309,-70.7654314),
    "OCEANIA CON EL ABETO . VILLA COMERCIO": (-33.4567381,-70.7569805),
    ##### FAKE VALUES
    "ISLA ADELAIDA #8779": (-33.4567381,-70.7569805),
    "OCEANIA #385": (-33.4567381,-70.7569805),
    "JORGE PRATT CON MAR DEL SUR": (-33.4567381,-70.7569805),
    "PUERTO ELVIRA CON PUERTO FUY": (-33.4567381,-70.7569805),
    "EL RACIMO #389": (-33.4567381,-70.7569805),
    "PUERTO ANTOFAGASTA #8367": (-33.4567381,-70.7569805),
    "PUERTO CHAÑARAL #8293": (-33.4567381,-70.7569805),
    "LEBRELES #8440": (-33.4567381,-70.7569805),
    "AV LA ESTRELLA #962. CASA DE TOD@S": (-33.4567381,-70.7569805),
    "MAR CARIBE #1241": (-33.4567381,-70.7569805),
    "NICANOR MOLINARE CON RIO ATRATO": (-33.4567381,-70.7569805),
    "SAN PABLO #8402. MULTICANCHA INTERIOR": (-33.4567381,-70.7569805),
    "GORBEA #1301. SEDE ESTRELLA DE CHILE": (-33.4567381,-70.7569805),
    "SEDE EL ESTRIBO CON KOCH": (-33.4567381,-70.7569805),
    "MULTICANCHA EL ESTRIBO CON KOCH": (-33.4567381,-70.7569805),
    "MARTINICA #1222": (-33.4567381,-70.7569805),
    "SALAR SURIRE #1234": (-33.4567381,-70.7569805),
    "ANDRES BELLO #1427": (-33.4567381,-70.7569805),
    "SANTA ANA #976": (-33.4567381,-70.7569805),
    "GENERAL BONILLA 8560. CANCHA 10": (-33.4567381,-70.7569805),
    "PATINODROMO MUNICIPAL. GENERAL BONILLA": (-33.4567381,-70.7569805),
    "CORONA SUECA JV LA PRIMAVERA": (-33.4567381,-70.7569805),
    "SAN PABLO #8428. BIBLIOTECA MUNICIPAL": (-33.4567381,-70.7569805),
    "LAS CARMELITAS #9438. VILLA SANTA BEATRIZ": (-33.4567381,-70.7569805),
    "HERALDICA #8897": (-33.4567381,-70.7569805),
    "COPAIPO #1252": (-33.4567381,-70.7569805),
    "RIO BUENO #8947": (-33.4567381,-70.7569805),
    "SAN DANIEL #9052": (-33.4567381,-70.7569805),
    "SIMON BOLIVAR KM 17. LICEO CUIDAD DE BRASILIA": (-33.4567381,-70.7569805),
    "PASAJE LAS LILAS. VILLA COUSO": (-33.4567381,-70.7569805),
    "SEDE CAMPO ALEGRE": (-33.4567381,-70.7569805),
    "SIMON BOLIVAR KM 17. PLAZA LOS COLONOS": (-33.4567381,-70.7569805),
    "LEBRELES #8440": (-33.4567381,-70.7569805),
    "PJE PAJARITO CON LOS LIBERTADORES #36": (-33.4567381,-70.7569805),
    "CALLE CURACAUTIN #7030": (-33.4567381,-70.7569805),
    "PEDRO PRADO CON VALPARAISO": (-33.4567381,-70.7569805),
    "LAS GARZAS CON LAS ALONDRAS": (-33.4567381,-70.7569805),
    "AV LAS FLORES CON COLISEO": (-33.4567381,-70.7569805),
    "GENERAL BONILLA #8450. CANCHA 11": (-33.4567381,-70.7569805),
    "GENERAL BONILLA #8450. CANCHA 12 - 13": (-33.4567381,-70.7569805),
    "COMPLEJO CLAUDIO ARRAU #9469": (-33.4567381,-70.7569805),
    "GENERAL BONILLA #8450. CANCHA 12": (-33.4567381,-70.7569805),
    "GENERAL BONILLA #8450. CANCHA 10": (-33.4567381,-70.7569805),
    "GENERAL BONILLA #8450. CANCHA 11": (-33.4567381,-70.7569805),
}

@st.cache_data
def get_data():
    file_path = 'PUDAHUEL_TALLERES_DEPORTIVOS_PRIMAVERA_VERANO_2024.xlsx'
    data = pd.read_excel(file_path)
    data.columns = ['Taller', 'Dias', 'Horario', 'Ubicacion', 'Monitor']
    data = data.drop_duplicates().apply(lambda x: x.str.strip() if x.dtype == "object" else x)
    data['Coordenadas'] = data['Ubicacion'].map(ubicaciones_coords)

    return data